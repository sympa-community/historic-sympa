
<H1><A NAME="SECTION001300000000000000000"><tex2html_anchor_invisible_mark></A>
<A NAME="authn"><tex2html_anchor_mark></A><BR>
12. Authentication
</H1>

<P>
<I>Sympa</I> needs to authenticate users (subscribers, owners, moderators, listmaster) on both its
mail and web interface to then apply appropriate privileges (authorization process) to subsequent 
requested actions. <I>Sympa</I> is able to cope with multiple authentication means on the client side and 
when using user+password it can validate these credentials against LDAP authentication backends.

<P>
When contacted on the mail interface <I>Sympa</I> has 3 authentication levels. Lower level is to trust
the <A NAME="8384"><tex2html_anchor_invisible_mark></A><TT>From:</TT> SMTP header field. A higher level of authentication will require that the 
user confirms his/her message. The strongest supported authentication method is S/MIME (note that <I>Sympa</I> 
also deals with S/MIME encrypted messages).

<P>
On the <I>Sympa</I> web interface (<A NAME="8389"><tex2html_anchor_invisible_mark></A><I>WWSympa</I>) the user can authenticate in 4 different ways (if appropriate setup
has been done on <I>Sympa</I> serveur). Default authentication mean is via the user's email address and a password 
managed by <I>Sympa</I> itself. If an LDAP authentication backend (or multiple) has been defined, then the user 
can authentication with his/her LDAP uid and password. <I>Sympa</I> is also able to delegate the authentication
job to a web Single SignOn system ; currently <A NAME="tex2html32"
  HREF="http://www.yale.edu/tp/auth/">CAS</A>
(the Yale University system) or a generic SSO setup, adapted to SSO products providing an Apache module. 
When contacted via HTTPS, <I>Sympa</I> can make use of X509 client certificates to authenticate users.

<P>
The authorization process in <I>Sympa</I> (authorization scenarios) refers to authentication methods. The 
same authorization scenarios are used for both mail and web accesss ; therefore some authentication 
methods are considered as equivalent : mail confirmation (on the mail interface) is equivalent to
password authentication (on the web interface) ; S/MIME authentication is equivalent to HTTPS with
client certificate authentication. Each rule in authorization scenarios requires an authentication method 
(<A NAME="8397"><tex2html_anchor_invisible_mark></A><TT>smtp</TT>,<A NAME="8400"><tex2html_anchor_invisible_mark></A><TT>md5</TT> or <A NAME="8403"><tex2html_anchor_invisible_mark></A><TT>smime</TT>) ; if the required authentication method was 
not used, a higher authentication mode can be requested.

<P>

<H1><A NAME="SECTION001310000000000000000">
12.1 S/MIME and HTTPS authentication</A>
</H1>

<P>
Chapter <A HREF=<tex2html_cr_mark>#smime-sig#1566><tex2html_cr_mark></A> (page~<A HREF=<tex2html_cr_mark>#smime-sig#1567><tex2html_cross_ref_visible_mark></A>) deals with <I>Sympa</I> and S/MIME signature.
<I>Sympa</I> uses <TT>OpenSSL</TT> library to work on S/MIME messages, you need to configure some
related <I>Sympa</I> parameters : <A HREF=<tex2html_cr_mark>#smimeconf#1569><tex2html_cr_mark></A> (page~<A HREF=<tex2html_cr_mark>#smimeconf#1570><tex2html_cross_ref_visible_mark></A>).

<P>
<I>Sympa</I> HTTPS authentication is based on Apache+mod_SSL that provide the required authentication
information via CGI environment variables. You will need to edit Apache configuration to 
allow HTTPS access and require X509 client certificate. Here is a sample Apache configuration

<P>
<BLOCKQUOTE>
</BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim314#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>

<P>

<H1><A NAME="SECTION001320000000000000000"><tex2html_anchor_invisible_mark></A>
<A NAME="ldap-auth"><tex2html_anchor_mark></A><BR>
12.2 Authentication with email address, uid or alternate email address
</H1>

<P>
<I>Sympa</I> stores the data relative to the subscribers in a DataBase. Among these data: password, email exploited during the Web authentication. The  module of <A NAME="8411"><tex2html_anchor_invisible_mark></A>LDAP authentication allows to use <I>Sympa</I> in an intranet without duplicating user passwords. 

<P>
This way users can indifferently authenticate with their ldap_uid, their alternate_email or their canonic email stored in the <A NAME="8413"><tex2html_anchor_invisible_mark></A>LDAP directory.

<P>
<I>Sympa</I> gets the canonic email in the <A NAME="8415"><tex2html_anchor_invisible_mark></A>LDAP directory with the ldap_uid or the alternate_email.  
<I>Sympa</I> will first attempt an anonymous bind to the directory to get the user's DN, then <I>Sympa</I> will bind with the DN and the user's ldap_password in order to perform an efficient authentication. This last bind will work only if the good ldap_password is provided. Indeed the value returned by the bind(DN,ldap_password) is tested.

<P>
Example: a person is described by
<BLOCKQUOTE>
</BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim315#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>

<P>
So Fabrice Rafart can be authenticated with: frafart, Fabrice.Rafart@MaSociete.fr, frafart@MaSociete.fr,Rafart@MaSociete.fr.
After this operation, the address in the field FROM will be the Canonic email, in this case  Fabrice.Rafart@MaSociete.fr. 
That means that <I>Sympa</I> will get this email and use it during all the session until you clearly ask <I>Sympa</I> to change your email address via the two pages : which and pref.

<P>

<H1><A NAME="SECTION001330000000000000000"><tex2html_anchor_invisible_mark></A>
<A NAME="generic-sso"><tex2html_anchor_mark></A><BR>
12.3 Generic SSO authentication
</H1>

<P>
The authentication method has first been introduced to allow interraction with <A NAME="tex2html33"
  HREF="http://shibboleth.internet2.edu/">Shibboleth</A>, Internet2's inter-institutional authentication system. But it should be usable with any SSO system that provides an Apache authentication module being able to protect a specified URL on the site (not the whole site). Here is a sample httpd.conf that shib-protects the associated Sympa URL :
<BLOCKQUOTE>
</BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim316#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>

<P>
<I>Sympa</I> will get user attributes via environment variables. In the most simple case the SSO will provide the user email address. If not, Sympa can be configured to look for the user email address in a LDAP directory (the search filter will make use of user information inherited from the SSO Apache module).

<P>
To plug a new SSO server in your Sympa server you should add a <B>generic_sso</B> paragraph (describing the SSO service) in your <A NAME="8421"><tex2html_anchor_invisible_mark></A><TT>auth.conf</TT> configuration file (See  <A HREF=<tex2html_cr_mark>#generic-sso-format#1594><tex2html_cr_mark></A>, page~<A HREF=<tex2html_cr_mark>#generic-sso-format#1595><tex2html_cross_ref_visible_mark></A>). Once this paragraph has been added, the SSO service name will be automatically added to the web login menu.

<P>
Apart from the user email address, the SSO can provide other user attributes that <I>Sympa</I> will store in the user_table DB table (for persistancy) and make them available in the [user_attributes] structure that you can use within authorization scenarios (see~<A HREF=<tex2html_cr_mark>#rules#1596><tex2html_cr_mark></A>, page~<A HREF=<tex2html_cr_mark>#rules#1597><tex2html_cross_ref_visible_mark></A>) or in web templates via the [<tex2html_percent_mark> user.attributes <tex2html_percent_mark>] structure.

<P>

<H1><A NAME="SECTION001340000000000000000"><tex2html_anchor_invisible_mark></A>
<A NAME="cas"><tex2html_anchor_mark></A><BR>
12.4 CAS-based authentication
</H1>

<P>
CAS is Yale university SSO software. Sympa can use CAS authentication service.

<P>
The listmaster should define at least one or more CAS servers (<B>cas</B> paragraph) in <A NAME="8425"><tex2html_anchor_invisible_mark></A><TT>auth.conf</TT>. If <B>non_blocking_redirection</B> parameter was set for a CAS server then Sympa will try a transparent login on this server
when the user accesses the web interface. If one CAS server redirect the user to Sympa with a valid ticket Sympa receives a user ID from the CAS server. It then connects to the related LDAP directory to get the user email address. If no CAS server returns a valid user ID, Sympa will let the user either select a CAS server to login or perform a Sympa login.

<P>

<H1><A NAME="SECTION001350000000000000000"><tex2html_anchor_invisible_mark></A>
<A NAME="auth-conf"><tex2html_anchor_mark></A><BR>
12.5 auth.conf
</H1>

<P>
The <A NAME="8428"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-ff//etc/auth.conf</TT> configuration file contains numerous
parameters which are read on start-up of <I>Sympa</I>. If you change this file, do not forget
that you will need to restart wwsympa.fcgi afterwards. 

<P>
The <A NAME="8432"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-ff//etc/auth.conf</TT> is organised in paragraphs. Each paragraph describes an authentication 
service with all required parameters to perform an authentication using this service. Current version of
<I>Sympa</I> can perform authentication through LDAP directories, using an external Single Sign-On Service (like CAS 
or Shibboleth), or using internal user_table.

<P>
The login page contains 2 forms : the login form and the SSO. When users hit the login form, each ldap or user_table authentication
paragraph is applied unless email adress input from form match the <A NAME="8436"><tex2html_anchor_invisible_mark></A><TT>negative_regexp</TT> or do not match <A NAME="8439"><tex2html_anchor_invisible_mark></A><TT>regexp</TT>. 
 <A NAME="8442"><tex2html_anchor_invisible_mark></A><TT>negative_regexp</TT> and <A NAME="8445"><tex2html_anchor_invisible_mark></A><TT>regexp</TT> can be defined for earch ldap or user_table authentication service so
administrator can block some authentication methode for class of users.

<P>
The segond form in login page contain the list of CAS server so user can choose explicitely his CAS service.

<P>
Each paragraph start with one of the keyword cas, ldap or user_table  

<P>
The <A NAME="8448"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-ff//etc/auth.conf</TT> file contains directives in the following format:

<P>
<BLOCKQUOTE>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE><I>paragraphs</I>
<BR>    <I>keyword    value</I>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE><I>paragraphs</I>
<BR>    <I>keyword    value</I> 
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>
</BLOCKQUOTE>

<P>
Comments start with the <TT>#</TT> character at the beginning of a line.

<P>
Empty lines are also considered as comments and are ignored at the beginning. After the first paragraph they are considered as paragraphs separators.
There should only be one directive per line, but their order in the paragraph is of no importance.

<P>
Example :

<P>
<BLOCKQUOTE>
</BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim317#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>

<P>

<H2><A NAME="SECTION001351000000000000000">
12.5.1 user_table paragraph</A>
</H2>

<P>
The user_table paragraph is related to sympa internal authentication by email and password. It is the simplest one the only parameters
are <A NAME="8451"><tex2html_anchor_invisible_mark></A><TT>regexp</TT> or <A NAME="8454"><tex2html_anchor_invisible_mark></A><TT>negative_regexp</TT> which are perl regular expressions applied on a provided email address to select or block this authentication method for a subset of email addresses. 

<P>

<H2><A NAME="SECTION001352000000000000000">
12.5.2 ldap paragraph</A>
</H2>

<P>

<UL>
<LI><#5860#><A NAME="8457"><tex2html_anchor_invisible_mark></A><TT>regexp</TT> and <A NAME="8460"><tex2html_anchor_invisible_mark></A><TT>negative_regexp</TT><#5860#>
	Same as in user_table paragraph : if a provided email address (does not apply to an uid), then the
	regular expression will be applied to find out if this LDAP directory can be used to authenticate a
	subset of users.

<P>
</LI>
<LI><#1630#>host<#1630#>
<BR>
<P>
This keyword is <B>mandatory</B>. It is the domain name
	used in order to bind to the directory and then to extract informations.
	You must mention the port number after the server name.
	Server replication is supported by listing several servers separated by commas.

<P>
Example :
	<BLOCKQUOTE>
</BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim318#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>

<P>
</LI>
<LI><#1636#>timeout<#1636#>
<BR>
<P>
It corresponds to the timelimit in the Search fonction. A timelimit that restricts the maximum 
	time (in seconds) allowed for a search. A value of 0 (the default), means that no timelimit
        will be requested.

<P>
</LI>
<LI><#1637#>suffix<#1637#>
<BR>
<P>
The root of the DIT (Directory Information Tree). The DN that is the base object entry relative 
	to which the search is to be performed. 

<P>
 Example: <TT>dc=university,dc=fr</TT>

<P>
</LI>
<LI><#1639#>bind_dn<#1639#>
<BR>
<P>
If anonymous bind is not allowed on the LDAP server, a DN and password can be used.

<P>
</LI>
<LI><#1640#>bind_password<#1640#>
<BR>
<P>
This password is used, combined with the bind_dn above.

<P>
</LI>
<LI><#1641#>get_dn_by_uid_filter<#1641#>
<BR>
<P>
Defines the search filter corresponding to the ldap_uid. (RFC 2254 compliant).
	If you want to apply the filter on the user, use the variable ' [sender] '. It will work with every
	type of authentication (uid, alternate_email..). 

<P>
Example :
	<BLOCKQUOTE>
</BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim319#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>

<P>
</LI>
<LI><#1646#>get_dn_by_email_filter<#1646#>
<BR>
<P>
Defines the search filter corresponding to the email addresses (canonic and alternative).(RFC 2254 compliant). 
	If you want to apply the filter on the user, use the variable ' [sender] '. It will work with every
	type of authentication (uid, alternate_email..). 

<P>
Example: a person is described by

<P>
<BLOCKQUOTE>
</BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim320#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>

<P>
The filters can be :

<P>
<BLOCKQUOTE>
</BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim321#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>

<P>
</LI>
<LI><#1655#>email_attribute<#1655#>
<BR>
<P>
The name of the attribute for the canonic email in your directory : for instance mail, canonic_email, canonic_address ...
	In the previous example the canonic email is 'mail'.

<P>
</LI>
<LI><#1656#>alternative_email_attribute<#1656#>
<BR>
<P>
The name of the attribute for the alternate email in your directory : for instance alternate_email, mailalternateaddress, ...
	You make a list of these attributes separated by commas.

<P>
With this list <I>Sympa</I> creates a cookie which contains various information : the user is authenticated via Ldap or not, his alternate email. To store the alternate email is interesting when you want to canonify your preferences and subscriptions. 
	That is to say you want to use a unique address in User_table and Subscriber_table which is the canonic email.

<P>
</LI>
<LI><#1657#>scope<#1657#>
<BR>
<P>
(Default value: <TT>sub</TT>)
	By default the search is performed on the whole tree below the specified base object. This may be changed by 
	specifying a scope :

<P>

<UL>
<LI><#1660#>base<#1660#>
<BR>	Search only the base object.

<P>
</LI>
<LI><#1661#>one<#1661#>
<BR>	Search the entries immediately below the base object. 

<P>
</LI>
<LI><#1662#>sub<#1662#>
<BR>	Search the whole tree below the base object. This is the default. 

<P>
</LI>
</UL>

<P>
</LI>
<LI><#1664#>authentication_info_url<#1664#>
<BR>
<P>
Defines the URL of a document describing LDAP password management. When hitting Sympa's 
	<I>Send me a password</I> button, LDAP users will be redirected to this URL.

<P>
</LI>
<LI><#1666#>use_ssl<#1666#>

<P>
If set to <TT>1</TT>, connection to the LDAP server will use SSL (LDAPS).

<P>
</LI>
<LI><#1668#>ssl_version<#1668#>

<P>
This defines the version of the SSL/TLS protocol to use. Defaults of <A NAME="8466"><tex2html_anchor_invisible_mark></A>Net::LDAPS to <TT>sslv2/3</TT>, 
	other possible values are <TT>sslv2</TT>, <TT>sslv3</TT>, and <TT>tlsv1</TT>.

<P>
</LI>
<LI><#1674#>ssl_ciphers<#1674#>

<P>
Specify which subset of cipher suites are permissible for this connection, using the standard 
	OpenSSL string format. The default value of <A NAME="8467"><tex2html_anchor_invisible_mark></A>Net::LDAPS for ciphers is <TT>ALL</TT>, 
	which permits all ciphers, even those that don't encrypt!

<P>
</LI>
</UL>

<P>

<H2><A NAME="SECTION001353000000000000000"><tex2html_anchor_invisible_mark></A>
<A NAME="generic-sso-format"><tex2html_anchor_mark></A><BR>
12.5.3 generic_sso paragraph
</H2>

<P>

<UL>
<LI><#1681#>service_name<#1681#> 
<BR>This is the SSO service name that will be proposed to the user in the login banner menu.

<P>
</LI>
<LI><#1682#>service_id<#1682#> 
<BR>This service ID is used as a parameter by sympa to refer to the SSO service (instead of the service name). 

<P>
A corresponding URL on the local web server should be protected by the SSO system ; this URL would look like <B>http://yourhost.yourdomain/sympa/sso_login/inqueue</B> if the service_id is <B>inqueue</B>.

<P>
</LI>
<LI><#1685#>http_header_prefix<#1685#> 
<BR>Sympa gets user attributes from environment variables comming from the web server. These variables are then stored in the user_table DB table for later use in authorization scenarios (in  structure). Only environment variables starting with the defined prefix will kept.

<P>
</LI>
<LI><#1686#>email_http_header<#1686#> 
<BR>This parameter defines the environment variable that will contain the authenticated user's email address.

<P>
</LI>
</UL>

<P>
The following parameters define how Sympa can retrieve the user email address ; <B>these are only useful if the email_http_header entry was not defined :</B>

<P>

<UL>
<LI><#1690#>ldap_host<#1690#>
<BR>	The LDAP host Sympa will connect to fetch user email. The ldap_host include the
        port number and it may be a comma separated list of redondant host.   

<P>
</LI>
<LI><#1691#>ldap_bind_dn<#1691#>
<BR>	The DN used to bind to this server. Anonymous bind is used if this parameter is not defined.

<P>
</LI>
<LI><#1692#>ldap_bind_password<#1692#>
<BR>	The password used unless anonymous bind is used.

<P>
</LI>
<LI><#1693#>ldap_suffix<#1693#>
<BR>	The LDAP suffix used when seraching user email

<P>
</LI>
<LI><#1694#>ldap_scope<#1694#>
<BR>	The scope used when seraching user email, possible values are <TT>sub</TT>, <TT>base</TT>, and <TT>one</TT>.

<P>
</LI>
<LI><#1698#>ldap_get_email_by_uid_filter<#1698#>
<BR>	The filter to perform the email search. It can refer to any environment variables inherited from the SSO module, as shown below.
	Example : 
	<BLOCKQUOTE>
</BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim322#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>

<P>
</LI>
<LI><#1703#>ldap_email_attribute<#1703#>
<BR>	The attribut name to be used as user canonical email. In the current version of sympa only the first value returned by the LDAP server is used.

<P>
</LI>
<LI><#1704#>ldap_timeout<#1704#>
<BR>	The time out for the search.

<P>
</LI>
<LI><#1705#>ldap_use_ssl<#1705#>

<P>
If set to <TT>1</TT>, connection to the LDAP server will use SSL (LDAPS).

<P>
</LI>
<LI><#1707#>ldap_ssl_version<#1707#>

<P>
This defines the version of the SSL/TLS protocol to use. Defaults of <A NAME="8468"><tex2html_anchor_invisible_mark></A>Net::LDAPS to <TT>sslv2/3</TT>, 
	other possible values are <TT>sslv2</TT>, <TT>sslv3</TT>, and <TT>tlsv1</TT>.

<P>
</LI>
<LI><#1713#>ldap_ssl_ciphers<#1713#>

<P>
Specify which subset of cipher suites are permissible for this connection, using the  
	OpenSSL string format. The default value of <A NAME="8469"><tex2html_anchor_invisible_mark></A>Net::LDAPS for ciphers is <TT>ALL</TT>, 
	which permits all ciphers, even those that don't encrypt!

<P>
</LI>
</UL>

<P>

<H2><A NAME="SECTION001354000000000000000">
12.5.4 cas paragraph</A>
</H2>

<P>

<UL>
<LI><#1719#>auth_service_name<#1719#>
<BR>	The friendly user service name as shown by <I>Sympa</I> in the login page.

<P>
</LI>
<LI><#1720#>host<#1720#> (OBSOLETE) 
<BR>        This parameter has been replaced by <B>base_url</B> parameter

<P>
</LI>
<LI><#1722#>base_url<#1722#> 
<BR>
<P>
The base URL of the CAS server.

<P>
</LI>
<LI><#1723#>non_blocking_redirection<#1723#>
<BR>
<P>
This parameter concern only the first access to Sympa services by a user, it activate or not the non blocking
redirection to the related cas server to check automatically if the user as been previously authenticated with  this CAS server.
Possible values are <B>on</B>  <B>off</B>, default is  <B>on</B>. The redirection to CAS is use with
the cgi parameter <B>gateway=1</B> that specify to CAS server to always redirect the user to the origine
URL but just check if the user is logged. If active, the SSO service is effective and transparent, but in case
the CAS server is out of order the access to Sympa services is impossible.

<P>
</LI>
<LI><#1728#>login_uri<#1728#> (OBSOLETE) 
<BR>        This parameter has been replaced by <B>login_path</B> parameter.

<P>
</LI>
<LI><#1730#>login_path<#1730#> (OPTIONAL)
<BR>	The login service path

<P>
</LI>
<LI><#1731#>check_uri<#1731#> (OBSOLETE) 
<BR>        This parameter has been replaced by <B>service_validate_path</B> parameter

<P>
</LI>
<LI><#1733#>service_validate_path<#1733#> (OPTIONAL)
<BR>	The ticket validation service path

<P>
</LI>
<LI><#1734#>logout_uri<#1734#> (OBSOLETE) 
<BR>        This parameter has been replaced by <B>logout_path</B> parameter

<P>
</LI>
<LI><#1736#>logout_path<#1736#> (OPTIONAL)
<BR>	The logout service path

<P>
</LI>
<LI><#1737#>proxy_path<#1737#> (OPTIONAL)
<BR>	The proxy service path, used by Sympa SOAP server only.

<P>
</LI>
<LI><#1738#>proxy_validate_path<#1738#> (OPTIONAL)
<BR>	The proxy validate service path, used by Sympa SOAP server only.

<P>
</LI>
<LI><#1739#>ldap_host<#1739#>
<BR>	The LDAP host Sympa will connect to fetch user email when user uid is return by CAS service. The ldap_host include the
        port number and it may be a comma separated list of redondant host.   

<P>
</LI>
<LI><#1740#>ldap_bind_dn<#1740#>
<BR>	The DN used to bind to this server. Anonymous bind is used if this parameter is not defined.

<P>
</LI>
<LI><#1741#>ldap_bind_password<#1741#>
<BR>	The password used unless anonymous bind is used.

<P>
</LI>
<LI><#1742#>ldap_suffix<#1742#>
<BR>	The LDAP suffix used when seraching user email

<P>
</LI>
<LI><#1743#>ldap_scope<#1743#>
<BR>	The scope used when seraching user email, possible values are <TT>sub</TT>, <TT>base</TT>, and <TT>one</TT>.

<P>
</LI>
<LI><#1747#>ldap_get_email_by_uid_filter<#1747#>
<BR>	The filter to perform the email search.

<P>
</LI>
<LI><#1748#>ldap_email_attribute<#1748#>
<BR>	The attribut name to be use as user canonical email. In the current version of sympa only the first value returned by the LDAP server is used.

<P>
</LI>
<LI><#1749#>ldap_timeout<#1749#>
<BR>	The time out for the search.

<P>
</LI>
<LI><#1750#>ldap_use_ssl<#1750#>

<P>
If set to <TT>1</TT>, connection to the LDAP server will use SSL (LDAPS).

<P>
</LI>
<LI><#1752#>ldap_ssl_version<#1752#>

<P>
This defines the version of the SSL/TLS protocol to use. Defaults of <A NAME="8471"><tex2html_anchor_invisible_mark></A>Net::LDAPS to <TT>sslv2/3</TT>, 
	other possible values are <TT>sslv2</TT>, <TT>sslv3</TT>, and <TT>tlsv1</TT>.

<P>
</LI>
<LI><#1758#>ldap_ssl_ciphers<#1758#>

<P>
Specify which subset of cipher suites are permissible for this connection, using the  
	OpenSSL string format. The default value of <A NAME="8472"><tex2html_anchor_invisible_mark></A>Net::LDAPS for ciphers is <TT>ALL</TT>, 
	which permits all ciphers, even those that don't encrypt!

<P>
</LI>
</UL>

<P>

<H1><A NAME="SECTION001360000000000000000"><tex2html_anchor_invisible_mark></A><A NAME="8473"><tex2html_anchor_invisible_mark></A>
<A NAME="sharing-auth"><tex2html_anchor_mark></A><BR>
12.6 Sharing <I>WWSympa</I> authentication with other applications
</H1>

<P>
If your are not using a web Single SignOn system you might want to make other web applications collaborate with <I>Sympa</I>,
and share the same authentication system. <I>Sympa</I> uses
HTTP cookies to carry users' auth information from page to page.
This cookie carries no information concerning privileges. To make your application
work with <I>Sympa</I>, you have two possibilities :

<P>

<UL>
<LI>Delegating authentication operations to <A NAME="8479"><tex2html_anchor_invisible_mark></A><I>WWSympa</I> 
<BR>If you want to avoid spending a lot of time programming a CGI to do Login, Logout
and Remindpassword, you can copy <A NAME="8482"><tex2html_anchor_invisible_mark></A><I>WWSympa</I>'s login page to your 
application, and then make use of the cookie information within your application. 
The cookie format is :
<PRE><tex2html_verbatim_mark>verbatim323#</PRE>
where <TT>;SPMlt;</TT>user_email<TT>;SPMgt;</TT> is the user's complete e-mail address, and
<TT>;SPMlt;</TT>checksum<TT>;SPMgt;</TT> are the 8 last bytes of the a MD5 checksum of the <TT>;SPMlt;</TT>user_email<TT>;SPMgt;</TT>+<I>Sympa</I> <A NAME="8486"><tex2html_anchor_invisible_mark></A><TT>cookie</TT>
configuration parameter.
Your application needs to know what the <A NAME="8489"><tex2html_anchor_invisible_mark></A><TT>cookie</TT> parameter
is, so it can check the HTTP cookie validity ; this is a secret shared
between <A NAME="8492"><tex2html_anchor_invisible_mark></A><I>WWSympa</I> and your application.
<A NAME="8495"><tex2html_anchor_invisible_mark></A><I>WWSympa</I>'s <I>loginrequest</I> page can be called to return to the
referer URL when an action is performed. Here is a sample HTML anchor :

<P>
<PRE><tex2html_verbatim_mark>verbatim324#</PRE>

<P>
You can also have your own HTML page submitting data to <A NAME="8498"><tex2html_anchor_invisible_mark></A><TT>wwsympa.fcgi</TT> CGI. If you're
doing so, you can set the <TT>referer</TT> variable to another URI. You can also
set the <TT>failure_referer</TT> to make WWSympa redirect the client to a different
URI if login fails.

<P>
</LI>
<LI>Using <A NAME="8501"><tex2html_anchor_invisible_mark></A><I>WWSympa</I>'s HTTP cookie format within your auth module 
<BR>To cooperate with <A NAME="8504"><tex2html_anchor_invisible_mark></A><I>WWSympa</I>, you simply need to adopt its HTTP
cookie format and share the secret it uses to generate MD5 checksums,
i.e. the <A NAME="8507"><tex2html_anchor_invisible_mark></A><TT>cookie</TT> configuration parameter. In this way, <A NAME="8510"><tex2html_anchor_invisible_mark></A><I>WWSympa</I> 
will accept users authenticated through your application without
further authentication.

<P>
</LI>
</UL>

<P>

<H1><A NAME="SECTION001370000000000000000"><tex2html_anchor_invisible_mark></A>
<A NAME="external-auth"><tex2html_anchor_mark></A><BR>
12.7 Provide a Sympa login form in another application
</H1>

<P>
You can easily trigger a Sympa login from within another web page. The login form should look like this :
<BLOCKQUOTE>
</BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim325#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>

<P>
The example above does not only perform the login action but also redirects the user to another sympa page, a list web archives here. 
The  <TT>previous_action</TT> and <TT>previous_list</TT> variable define the action that will be performed after the login is done.

<P>

