<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with jLaTeX2HTML 2002-2-1 (1.70) JA patch-2.0
patched version by:  Kenshi Muto, Debian Project.
* modified by:  Shige TAKENO
LaTeX2HTML 2002-2-1 (1.70),
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>13. Virtual robot</TITLE>
<META NAME="description" CONTENT="13. Virtual robot">
<META NAME="keywords" CONTENT="sympa">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="jLaTeX2HTML v2002-2-1 JA patch-2.0">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="sympa.css">

<LINK REL="next" HREF="node15.html">
<LINK REL="previous" HREF="node13.html">
<LINK REL="up" HREF="sympa.html">
<LINK REL="next" HREF="node15.html">
</HEAD>

<BODY TEXT="#000000" BGCOLOR="#ffffff">
<!--Navigation Panel-->
<A NAME="tex2html1091"
  HREF="node15.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1085"
  HREF="sympa.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1079"
  HREF="node13.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1087"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1089"
  HREF="node26.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1092"
  HREF="node15.html">14. Customizing Sympa/WWSympa</A>
<B> Up:</B> <A NAME="tex2html1086"
  HREF="sympa.html">Sympa Mailing Lists Management Software version</A>
<B> Previous:</B> <A NAME="tex2html1080"
  HREF="node13.html">12. Authorization scenarios</A>
 &nbsp; <B>  <A NAME="tex2html1088"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1090"
  HREF="node26.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html1093"
  HREF="node14.html#SECTION001410000000000000000">13.1 How to create a virtual robot</A>
<LI><A NAME="tex2html1094"
  HREF="node14.html#SECTION001420000000000000000">13.2 robot.conf</A>
<UL>
<LI><A NAME="tex2html1095"
  HREF="node14.html#SECTION001421000000000000000">13.2.1 Robot customization</A>
</UL>
<BR>
<LI><A NAME="tex2html1096"
  HREF="node14.html#SECTION001430000000000000000">13.3 Managing multiple virtual robots</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION001400000000000000000"></A>
    <A NAME="virtual-robot"></A>
<BR>
13. Virtual robot
</H1>

<P>
Sympa is designed to manage multiple distinct mailing list servers on
a single host with a single Sympa installation. Sympa virtual robots
are like Apache virtual hosting. Sympa virtual robot definition includes
a specific email address for the robot itself and its lists and also a virtual
http server. Each robot provides access to a set of lists, each list is
related to only one robot.

<P>
Most configuration parameters can be redefined for each robot except 
general Sympa installation parameters (binary and spool location, smtp engine,
antivirus plugging,...).

<P>
The Virtual robot name as defined in <I>Sympa</I> documentation and configuration file refers
to the Internet domaine of the Virtual robot.

<P>
Note that the main limitation of virtual robots in Sympa is that you cannot create 
2 lists with the same name (local part) among your virtual robots.

<P>

<H1><A NAME="SECTION001410000000000000000">
13.1 How to create a virtual robot</A>
</H1>

<P>
You don't need to install several Sympa servers. A single <A NAME="7304"></A><TT>sympa.pl</TT> daemon
and one or more fastcgi servers can serve all virtual robot. Just configure the 
server environment in order to accept the new domain definition.

<UL>
<LI><B>The DNS</B> must be configured to define a new mail exchanger record (MX) 
to route message to your server. A new host (A record) or alias (CNAME) are mandatory
to define the new web server.
</LI>
<LI>Configure your <B>MTA (sendmail, postfix, exim, ...)</B> to accept incoming 
messages for the new robot domain. Add mail aliases for the robot :

<P>
<I>Examples (with sendmail):</I> <PRE>
sympa@your.virtual.domain:      "| /usr/local/sympa-os/bin/queue sympa@your.virtual.domain"
listmaster@your.virtual.domain: "| /usr/local/sympa-os/bin/queue listmaster@your.virtual.domain"
</PRE>

<P>
</LI>
<LI>Define a <B>virtual host in your HTTPD server</B>. The fastcgi servers defined 
in the common section of you httpd server can be used by each virtual host. You don't 
need to run dedicated fascgi server for each virtual robot.

<P>
<I>Examples:</I> <PRE>
FastCgiServer /usr/local/sympa-os/bin/wwsympa.fcgi -processes 3 -idle-timeout 120
.....
&lt;VirtualHost 195.215.92.16&gt;
  ServerAdmin webmaster@your.virtual.domain
  DocumentRoot /var/www/your.virtual.domain
  ServerName your.virtual.domain

  &lt;Location /sympa&gt;
     SetHandler fastcgi-script
  &lt;/Location&gt;

  ScriptAlias /sympa /usr/local/sympa-os/bin/wwsympa.fcgi

&lt;/VirtualHost&gt;
</PRE>

<P>
</LI>
<LI>Create a <A NAME="7307"></A><TT>/usr/local/sympa-os/etc/your.virtual.domain/robot.conf</TT> configuration file for the virtual robot. Its format is a subset of <A NAME="7310"></A><TT>sympa.conf</TT> and is described in the next section ; a sample <A NAME="7313"></A><TT>robot.conf</TT> is provided.

<P>
</LI>
<LI>Create a <A NAME="7316"></A><TT>/usr/local/sympa-os/expl/your.virtual.domain/</TT> directory that will contain the virtual robot mailing lists directories. This directory should have the  <I>sympa</I> user as its owner and must have read and write access for this user.

<P><PRE>
# su sympa -c 'mkdir /usr/local/sympa-os/expl/your.virtual.domain'
# chmod 750 /usr/local/sympa-os/expl/your.virtual.domain
</PRE>

<P>
</LI>
</UL>

<P>

<H1><A NAME="SECTION001420000000000000000">
13.2 robot.conf</A>
</H1>
A robot is named by its domain, let's say my.domain.organd defined by a directory 
<A NAME="7319"></A><TT>/usr/local/sympa-os/etc/my.domain.org</TT>. This directory must contain at least a 
<A NAME="7322"></A><TT>robot.conf</TT> file. This files has the same format as  <A NAME="7325"></A><TT>/usr/local/sympa-os/etc/sympa.conf</TT>
(have a look at robot.conf in the sample dir).
Only the following parameters can be redefined for a particular robot :

<P>

<UL>
<LI><A NAME="7328"></A><TT>http_host</TT> 
<BR>
This hostname will be compared with 'SERVER_NAME' environment variable in wwsympa.fcgi
	to determine the current Virtual Robot. You can a path at the end of this parameter if
	you are running multiple Virtual robots on the same host. 
	<PRE>Examples: \\
	http_host  myhost.mydom
	http_host  myhost.mydom/sympa
</PRE>

<P>
</LI>
<LI><A NAME="7331"></A><TT>wwsympa_url</TT> 
<BR>
The base URL of WWSympa

<P>
</LI>
<LI><A NAME="7334"></A><TT>soap_url</TT> 
<BR>
The base URL of Sympa's SOAP server (if it is running ; see&nbsp;<A HREF="node11.html#soap">10</A>, page&nbsp;<A HREF="node11.html#soap"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>)

<P>
</LI>
<LI><A NAME="7337"></A><TT>cookie_domain</TT>

<P>
</LI>
<LI><A NAME="7340"></A><TT>email</TT>

<P>
</LI>
<LI><A NAME="7343"></A><TT>title</TT>

<P>
</LI>
<LI><A NAME="7346"></A><TT>default_home</TT>

<P>
</LI>
<LI><A NAME="7349"></A><TT>create_list</TT>

<P>
</LI>
<LI><A NAME="7352"></A><TT>lang</TT>

<P>
</LI>
<LI><A NAME="7355"></A><TT>supported_lang</TT>

<P>
</LI>
<LI><A NAME="7358"></A><TT>log_smtp</TT>

<P>
</LI>
<LI><A NAME="7361"></A><TT>listmaster</TT>

<P>
</LI>
<LI><A NAME="7364"></A><TT>max_size</TT>

<P>
</LI>
<LI><A NAME="7367"></A><TT>css_path</TT>

<P>
</LI>
<LI><A NAME="7370"></A><TT>css_url</TT>

<P>
</LI>
<LI><A NAME="7373"></A><TT>logo_html_definition</TT>

<P>
</LI>
<LI><A NAME="7376"></A><TT>color_0</TT>, color_1 ... color_15

<P>
</LI>
<LI>deprecated color definition <A NAME="7379"></A><TT>dark_color</TT>, <A NAME="7382"></A><TT>light_color</TT>, <A NAME="7385"></A><TT>text_color</TT>, <A NAME="7388"></A><TT>bg_color</TT>, <A NAME="7391"></A><TT>error_color</TT>, <A NAME="7394"></A><TT>selected_color</TT>, <A NAME="7397"></A><TT>shaded_color</TT>

<P>
</LI>
</UL>

<P>
These settings overwrite the equivalent global parameter defined in <A NAME="7400"></A><TT>/usr/local/sympa-os/etc/sympa.conf</TT>
for my.domain.orgrobot ; the main <A NAME="7403"></A><TT>listmaster</TT> still has privileges on Virtual
Robots though. The http_host parameter is compared by wwsympa with the SERVER_NAME
environment variable to recognize which robot is in used. 

<P>

<H2><A NAME="SECTION001421000000000000000">
13.2.1 Robot customization</A>
</H2>

<P>
In order to customize the web look and feel, you may edit the CSS definition. CSS are defined in a template named css.tt2. Any robot can use static css file for making Sympa web interface faster. Then you can edit this static definition and change web style. Please refer to  <A NAME="7406"></A><TT>css_path</TT> <A NAME="7409"></A><TT>css_url</TT>. You can also quickly introduce a logo in left top corner of all pages configuring <A NAME="7412"></A><TT>logo_html_definition</TT> parameter in robot.conf file. 

<P>
In addition, if needed, you can customize each virtual robot using its set of templates and authorization scenarios. 

<P>
<A NAME="7415"></A><TT>/usr/local/sympa-os/etc/my.domain.org/web_tt2/</TT>,
<A NAME="7418"></A><TT>/usr/local/sympa-os/etc/my.domain.org/mail_tt2/</TT>, 
<A NAME="7421"></A><TT>/usr/local/sympa-os/etc/my.domain.org/scenari/</TT> directories are searched when
loading templates or scenari before searching into <A NAME="7424"></A><TT>/usr/local/sympa-os/etc</TT> and  <A NAME="7427"></A><TT>/usr/local/sympa-os/bin/etc</TT>. This allows to define different privileges and a different GUI for a Virtual Robot.

<P>

<H1><A NAME="SECTION001430000000000000000">
13.3 Managing multiple virtual robots</A>
</H1>

<P>
If you are managing more than 2 virtual robots, then you might cinsider moving all the mailing lists in the default
robot to a dedicated virtual robot located in the <A NAME="7430"></A><TT>/usr/local/sympa-os/expl/my.domain.org/</TT> directory. The main benefit of 
this organisation is the ability to define default configuration elements (templates or authorization scenarios) 
for this robot without inheriting them within other virtual robots.

<P>
To create such a virtual robot, you need to create <A NAME="7433"></A><TT>/usr/local/sympa-os/expl/my.domain.org/</TT> and <A NAME="7436"></A><TT>/usr/local/sympa-os/etc/my.domain.org/</TT> directories ; 
customize <A NAME="7439"></A><TT>host</TT>, <A NAME="7442"></A><TT>http_host</TT> and <A NAME="7445"></A><TT>wwsympa_url</TT> parameters in the <A NAME="7448"></A><TT>/usr/local/sympa-os/etc/my.domain.org/robot.conf</TT> 
with the same values as the default robot (as defined in <A NAME="7451"></A><TT>sympa.conf</TT> and <A NAME="7454"></A><TT>wwsympa.conf</TT> files).

<P>

<HR>
<!--Navigation Panel-->
<A NAME="tex2html1091"
  HREF="node15.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1085"
  HREF="sympa.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1079"
  HREF="node13.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1087"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1089"
  HREF="node26.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1092"
  HREF="node15.html">14. Customizing Sympa/WWSympa</A>
<B> Up:</B> <A NAME="tex2html1086"
  HREF="sympa.html">Sympa Mailing Lists Management Software version</A>
<B> Previous:</B> <A NAME="tex2html1080"
  HREF="node13.html">12. Authorization scenarios</A>
 &nbsp; <B>  <A NAME="tex2html1088"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1090"
  HREF="node26.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
root
2005-09-30
</ADDRESS>
</BODY>
</HTML>
