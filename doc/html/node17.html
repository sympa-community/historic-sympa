
<H1><A NAME="SECTION001700000000000000000"><tex2html_anchor_invisible_mark></A><A NAME="8487"><tex2html_anchor_invisible_mark></A>
    <A NAME="customization"><tex2html_anchor_mark></A><BR>
16. Customizing <I>Sympa</I>/<I>WWSympa</I> 
</H1>

<P>

<H1><A NAME="SECTION001710000000000000000"><tex2html_anchor_invisible_mark></A>
<A NAME="tpl-format"><tex2html_anchor_mark></A><A NAME="1981"><tex2html_anchor_invisible_mark></A><BR>
16.1 Template file format
</H1>

<P>
Template files within <I>Sympa</I> used to be in a proprietary format that has been
replaced with the <A NAME="tex2html34"
  HREF="http://www.tt2.org">TT2</A>
template format.

<P>
You will find detailed documentation about the TT2 syntax on the web site : <B>http://www.tt2.org</B>

<P>
Here are some aspects regarding templates that are specific to <I>Sympa</I>: 

<UL>
<LI>References to PO catalogue are noted with the <B>[<tex2html_percent_mark> loc <tex2html_percent_mark>]</B> tag that may include 
  parameters. Example: <TT>[<tex2html_percent_mark>|loc(list.name,list.host)<tex2html_percent_mark>]Welcome to list <tex2html_percent_mark>1<tex2html_percent_mark>2[<tex2html_percent_mark>END<tex2html_percent_mark>]</TT>.

<P>
</LI>
<LI>Few exceptions apart, templates cannot insert or parse a file given its full or relative 
   path, for security reason. Only the file name should be provided ; the TT2 parser will then
   use the INCLUDE_PATH provided by <I>Sympa</I> to find the relevant file to insert/parse.

<P>
</LI>
<LI>The <B>qencode</B> filter should be used if a template includes SMTP header fields
  that should be Q-encoded. Example: <TT>[<tex2html_percent_mark> FILTER qencode <tex2html_percent_mark>]Message &#224; mod&#233;rer[<tex2html_percent_mark>END<tex2html_percent_mark>]</TT>

<P>
</LI>
<LI>You can write different versions of a template file in different language, each of them 
  being located in a subdirectory of the <B>tt2</B> directory. Example: <TT>/web_tt2/fr_FR/helpfile.tt2</TT>

<P>
</LI>
</UL>

<P>

<H1><A NAME="SECTION001720000000000000000"><tex2html_anchor_invisible_mark></A>
<A NAME="site-tpl"><tex2html_anchor_mark></A><A NAME="1995"><tex2html_anchor_invisible_mark></A><BR>
16.2 Site template files
</H1>

<P>
These files are used by Sympa as service messages for the <A NAME="8496"><tex2html_anchor_invisible_mark></A><TT>HELP</TT>, 
<A NAME="8499"><tex2html_anchor_invisible_mark></A><TT>LISTS</TT> and <A NAME="8502"><tex2html_anchor_invisible_mark></A><TT>REMIND *</TT> commands. These files are interpreted 
(parsed) by <I>Sympa</I> and respect the TT2 template format ; every file has a <B>.tt2</B> extension. 
See <A HREF=<tex2html_cr_mark>#tpl-format#2000><tex2html_cr_mark></A>, 
page~<A HREF=<tex2html_cr_mark>#tpl-format#2001><tex2html_cross_ref_visible_mark></A>. 

<P>
Sympa looks for these files in the following order (where <TT>;SPMlt;</TT>list<TT>;SPMgt;</TT> is the
listname if defined, <TT>;SPMlt;</TT>action<TT>;SPMgt;</TT> is the name of the command, and <TT>;SPMlt;</TT>lang<TT>;SPMgt;</TT> is
the preferred language of the user) :

<OL>
<LI><A NAME="8530"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/expl/<TT>;SPMlt;</TT>list<TT>;SPMgt;</TT>/mail_tt2/<TT>;SPMlt;</TT>lang<TT>;SPMgt;</TT>/<TT>;SPMlt;</TT>action<TT>;SPMgt;</TT>.tt2</TT>. 
</LI>
<LI><A NAME="8569"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/expl/<TT>;SPMlt;</TT>list<TT>;SPMgt;</TT>/mail_tt2/<TT>;SPMlt;</TT>action<TT>;SPMgt;</TT>.tt2</TT>. 
</LI>
<LI><A NAME="8602"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/etc/my.domain.org/mail_tt2/<TT>;SPMlt;</TT>lang<TT>;SPMgt;</TT>/<TT>;SPMlt;</TT>action<TT>;SPMgt;</TT>.tt2</TT>. 
</LI>
<LI><A NAME="8629"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/etc/my.domain.org/mail_tt2/<TT>;SPMlt;</TT>action<TT>;SPMgt;</TT>.tt2</TT>. 
</LI>
<LI><A NAME="8656"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/etc/mail_tt2/<TT>;SPMlt;</TT>lang<TT>;SPMgt;</TT>/<TT>;SPMlt;</TT>action<TT>;SPMgt;</TT>.tt2</TT>. 
</LI>
<LI><A NAME="8683"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/etc/mail_tt2/<TT>;SPMlt;</TT>action<TT>;SPMgt;</TT>.tt2</TT>. 
</LI>
<LI><A NAME="8710"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/bin/etc/mail_tt2/<TT>;SPMlt;</TT>lang<TT>;SPMgt;</TT>/<TT>;SPMlt;</TT>action<TT>;SPMgt;</TT>.tt2</TT>.
</LI>
<LI><A NAME="8737"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/bin/etc/mail_tt2/<TT>;SPMlt;</TT>action<TT>;SPMgt;</TT>.tt2</TT>.
</LI>
</OL>

<P>
If the file starts with a From: line, it is considered as
a full message and will be sent (after parsing) without adding SMTP
headers. Otherwise the file is treated as a text/plain message body.

<P>
The following variables may be used in these template files :

<P>
<DL COMPACT>
<DT><#30076#><#30067#>-<#30067#><#30076#></DT>
<DD>[<tex2html_percent_mark> conf.email <tex2html_percent_mark>] : sympa e-mail address local part

<P>
</DD>
<DT><#30077#><#30068#>-<#30068#><#30077#></DT>
<DD>[<tex2html_percent_mark> conf.domain <tex2html_percent_mark>] : sympa robot domain name

<P>
</DD>
<DT><#30078#><#30069#>-<#30069#><#30078#></DT>
<DD>[<tex2html_percent_mark> conf.sympa <tex2html_percent_mark>] : sympa's complete e-mail address

<P>
</DD>
<DT><#30079#><#30070#>-<#30070#><#30079#></DT>
<DD>[<tex2html_percent_mark> conf.wwsympa_url <tex2html_percent_mark>] : <A NAME="8746"><tex2html_anchor_invisible_mark></A><I>WWSympa</I> root URL

<P>
</DD>
<DT><#30080#><#30071#>-<#30071#><#30080#></DT>
<DD>[<tex2html_percent_mark> conf.listmaster <tex2html_percent_mark>] : listmaster e-mail addresses

<P>
</DD>
<DT><#30081#><#30072#>-<#30072#><#30081#></DT>
<DD>[<tex2html_percent_mark> user.email <tex2html_percent_mark>] : user e-mail address

<P>
</DD>
<DT><#30082#><#30073#>-<#30073#><#30082#></DT>
<DD>[<tex2html_percent_mark> user.gecos <tex2html_percent_mark>] : user gecos field (usually his/her name)

<P>
</DD>
<DT><#30083#><#30074#>-<#30074#><#30083#></DT>
<DD>[<tex2html_percent_mark> user.password <tex2html_percent_mark>] : user password

<P>
</DD>
<DT><#30084#><#30075#>-<#30075#><#30084#></DT>
<DD>[<tex2html_percent_mark> user.lang <tex2html_percent_mark>] : user language	
</DD>
</DL>

<P>

<H2><A NAME="SECTION001721000000000000000">
16.2.1 helpfile.tt2</A>
</H2> 

<P>
This file is sent in response to a <A NAME="8749"><tex2html_anchor_invisible_mark></A><TT>HELP</TT> command. 
	You may use additional variables
<DL COMPACT>
<DT><#30088#><#30086#>-<#30086#><#30088#></DT>
<DD>[<tex2html_percent_mark> is_owner <tex2html_percent_mark>] : TRUE if the user is list owner

<P>
</DD>
<DT><#30089#><#30087#>-<#30087#><#30089#></DT>
<DD>[<tex2html_percent_mark> is_editor <tex2html_percent_mark>] : TRUE if the user is list editor

<P>
</DD>
</DL>

<P>

<H2><A NAME="SECTION001722000000000000000">
16.2.2 lists.tt2</A>
</H2> 

<P>
File returned by <A NAME="8752"><tex2html_anchor_invisible_mark></A><TT>LISTS</TT> command. 
	An additional variable is available :
<DL COMPACT>
<DT><#30092#><#30091#>-<#30091#><#30092#></DT>
<DD>[<tex2html_percent_mark> lists <tex2html_percent_mark>] : this is a hash table indexed by list names and
			containing lists' subjects. Only lists visible
			to this user (according to the <A NAME="8755"><tex2html_anchor_invisible_mark></A><TT>visibility</TT> 
			list parameter) are listed.
</DD>
</DL>

<P>
<I>Example:</I> 

<P>
<BLOCKQUOTE>
</BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim330#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>

<P>

<H2><A NAME="SECTION001723000000000000000">
16.2.3 global_remind.tt2</A>
</H2> 

<P>
This file is sent in response to a <A NAME="8758"><tex2html_anchor_invisible_mark></A><TT>REMIND *</TT> command. 
	(see~<A HREF=<tex2html_cr_mark>#cmd-remind#2056><tex2html_cr_mark></A>, page~<A HREF=<tex2html_cr_mark>#cmd-remind#2057><tex2html_cross_ref_visible_mark></A>)
	You may use additional variables
<DL COMPACT>
<DT><#30095#><#30094#>-<#30094#><#30095#></DT>
<DD>[<tex2html_percent_mark> lists <tex2html_percent_mark>] : this is an array containing the list names the user
			is subscribed to.
</DD>
</DL>

<P>
<I>Example:</I> 

<P>
<BLOCKQUOTE>
</BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim331#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>

<P>

<H2><A NAME="SECTION001724000000000000000">
16.2.4 your_infected_msg.tt2</A>
</H2> 

<P>
This message is sent to warn the sender of a virus infected mail,
indicating the name of the virus found 
(see~<A HREF=<tex2html_cr_mark>#Antivirus#2066><tex2html_cr_mark></A>, page~<A HREF=<tex2html_cr_mark>#Antivirus#2067><tex2html_cross_ref_visible_mark></A>).

<P>

<H1><A NAME="SECTION001730000000000000000"><tex2html_anchor_invisible_mark></A>
<A NAME="web-tpl"><tex2html_anchor_mark></A><A NAME="2070"><tex2html_anchor_invisible_mark></A><BR>
16.3 Web template files
</H1>

<P>
You may define your own web template files, different from the standard
ones. <A NAME="8761"><tex2html_anchor_invisible_mark></A><I>WWSympa</I> first looks for list specific web templates, then for
site web templates, before falling back on its defaults. 

<P>
Your list web template files should be placed in the <A NAME="8764"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/expl/mylist/web_tt2</TT> 
directory ; your site web templates in <A NAME="8767"><tex2html_anchor_invisible_mark></A><TT>&#126;/usr/local/sympa-gb/etc/web_tt2</TT> directory.

<P>
Note that web colors are defined in <I>Sympa</I>'s main Makefile (see <A HREF=<tex2html_cr_mark>#makefile#2073><tex2html_cr_mark></A>,
page~<A HREF=<tex2html_cr_mark>#makefile#2074><tex2html_cross_ref_visible_mark></A>).

<P>

<H1><A NAME="SECTION001740000000000000000"><tex2html_anchor_invisible_mark></A>
<A NAME="internationalization"><tex2html_anchor_mark></A><A NAME="2077"><tex2html_anchor_invisible_mark></A>
<A NAME="2078"><tex2html_anchor_invisible_mark></A><BR>
16.4 Internationalization
</H1>

<P>
<I>Sympa</I> was originally designed as a multilingual Mailing List
Manager. Even in its earliest versions, <I>Sympa</I> separated messages from
the code itself, messages being stored in NLS catalogues (according 
to the XPG4 standard). Later a <A NAME="8775"><tex2html_anchor_invisible_mark></A><TT>lang</TT> list parameter was introduced.
Nowadays <I>Sympa</I> is able to keep track of individual users' language preferences.

<P>
If you are willing to provide Sympa into your native language, please check the <B>translation howto</B> (<A NAME="tex2html35"
  HREF="http://www.sympa.org/howtotranslate.html"><TT>http://www.sympa.org/howtotranslate.html</TT></A>);

<P>

<H2><A NAME="SECTION001741000000000000000">
16.4.1 <I>Sympa</I> internationalization</A>
</H2>

<P>
Every message sent by <I>Sympa</I> to users, owners and editors is outside
the code, in a message catalog. These catalogs are located in the
<A NAME="8781"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/locale</TT> directory. 

<P>
To tell <I>Sympa</I> to use a particular message catalog, you can should set 
the <A NAME="8785"><tex2html_anchor_invisible_mark></A><TT>lang</TT> parameter in <A NAME="8788"><tex2html_anchor_invisible_mark></A><TT>sympa.conf</TT>.

<P>

<H2><A NAME="SECTION001742000000000000000">
16.4.2 List internationalization</A>
</H2>

<P>
The <A NAME="8791"><tex2html_anchor_invisible_mark></A><TT>lang</TT> list parameter defines the language for a list.
It is currently used by <A NAME="8794"><tex2html_anchor_invisible_mark></A><I>WWSympa</I> and to initialize users'
language preferences at subscription time.

<P>
In future versions, all messages returned by <I>Sympa</I> concerning
a list should be in the list's language. 

<P>

<H2><A NAME="SECTION001743000000000000000">
16.4.3 User internationalization</A>
</H2>

<P>
The user language preference is currently used by <A NAME="8798"><tex2html_anchor_invisible_mark></A><I>WWSympa</I> 
only. There is no e-mail-based command for a user to set his/her
language. The language preference is initialized when the user
subscribes to his/her first list. <A NAME="8801"><tex2html_anchor_invisible_mark></A><I>WWSympa</I> allows the user to change 
it.

<P>

<H1><A NAME="SECTION001750000000000000000"><tex2html_anchor_invisible_mark></A>
<A NAME="topics"><tex2html_anchor_mark></A><A NAME="2092"><tex2html_anchor_invisible_mark></A><BR>
16.5 Topics
</H1>

<P>
<A NAME="8804"><tex2html_anchor_invisible_mark></A><I>WWSympa</I>'s homepage shows a list of topics for classifying
mailing lists. This is dynamically generated using the different lists'
<A NAME="8807"><tex2html_anchor_invisible_mark></A><TT>topics</TT> configuration parameters. A list may appear 
in multiple categories.

<P>
The list of topics is defined in the <A NAME="8810"><tex2html_anchor_invisible_mark></A><TT>topics.conf</TT> configuration
file, located in the <A NAME="8813"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/etc</TT> directory. The format of this file is 
as follows :
<BLOCKQUOTE>
</BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim332#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>

<P>
You will notice that subtopics can be used, the separator being <I>/</I>.
The topic name is composed of alphanumerics (0-1a-zA-Z) or underscores (_).
The order in which the topics are listed is respected in <A NAME="8816"><tex2html_anchor_invisible_mark></A><I>WWSympa</I>'s homepage.
The <B>visibility</B> line defines who can view the topic (now available for subtopics).
It refers to the associated topics_visibility authorization scenario.
You will find a sample <A NAME="8819"><tex2html_anchor_invisible_mark></A><TT>topics.conf</TT> in the <A NAME="8822"><tex2html_anchor_invisible_mark></A><TT>sample</TT> 
directory ; NONE is installed as the default. 

<P>
A default topic is hard-coded in <I>Sympa</I>: <I>default</I>. This default topic
contains all lists for which a topic has not been specified.

<P>

<H1><A NAME="SECTION001760000000000000000">
16.6 Authorization scenarios</A>
</H1>

<P>
See <A HREF=<tex2html_cr_mark>#scenarios#2106><tex2html_cr_mark></A>, page~<A HREF=<tex2html_cr_mark>#scenarios#2107><tex2html_cross_ref_visible_mark></A>.

<P>

<H1><A NAME="SECTION001770000000000000000"><tex2html_anchor_invisible_mark></A>
    <A NAME="loop-detection"><tex2html_anchor_mark></A>    <A NAME="2110"><tex2html_anchor_invisible_mark></A><BR>
16.7 Loop detection
</H1>

<P>
<I>Sympa</I> uses multiple heuristics to avoid loops in Mailing lists

<P>
First, it rejects messages coming from a robot (as indicated by the
From: and other header fields), and messages containing commands.

<P>
Secondly, every message sent by <I>Sympa</I> includes an X-Loop header field set to
the listname. If the message comes back, <I>Sympa</I> will detect that
it has already been sent (unless X-Loop header fields have been
erased).

<P>
Thirdly, <I>Sympa</I> keeps track of Message IDs and will refuse to send multiple
messages with the same message ID to the same mailing list.

<P>
Finally, <I>Sympa</I> detect loops arising from command reports (i.e. sympa-generated replies to commands). 
This sort of loop might occur as follows:

<P>
<BLOCKQUOTE>
</BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim333#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>

<P>
<I>Sympa</I> keeps track (via an internal counter) of reports sent to any particular address.
The loop detection algorithm is :

<P>

<UL>
<LI>Increment the counter

<P>
</LI>
<LI>If we are within the sampling period (as defined by the
	<A NAME="8832"><tex2html_anchor_invisible_mark></A><TT>loop_command_sampling_delay</TT> parameter)

<P>

<UL>
<LI>If the counter exceeds the 
		<A NAME="8835"><tex2html_anchor_invisible_mark></A><TT>loop_command_max</TT> parameter, then 
		do not send the report, and notify the listmaster

<P>
</LI>
<LI>Else, start a new sampling period and reinitialize
		the counter,  i.e. multiply it by the 
		<A NAME="8838"><tex2html_anchor_invisible_mark></A><TT>loop_command_decrease_factor</TT> parameter
	
</LI>
</UL>

<P>
</LI>
</UL>

<P>

<H1><A NAME="SECTION001780000000000000000"><tex2html_anchor_invisible_mark></A>
    <A NAME="tasks"><tex2html_anchor_mark></A>    <A NAME="2124"><tex2html_anchor_invisible_mark></A><BR>
16.8 Tasks
</H1>

<P>
A task is a sequence of simple actions which realize a complex routine. It is executed in background 
by the task manager daemon and allow the list master to automate the processing of recurrent tasks. 
For example a task sends every year the subscribers of a list a message to remind their subscription. 

<P>
A task is created with a task model. It is a text file which describes a sequence of simple actions. 
It may have different versions (for instance reminding subscribers every year or semester).
A task model file name has the following format : <A NAME="8859"><tex2html_anchor_invisible_mark></A><TT><TT>;SPMlt;</TT>model name<TT>;SPMgt;</TT>.<TT>;SPMlt;</TT>model version<TT>;SPMgt;</TT>.task</TT>.
For instance <A NAME="8874"><tex2html_anchor_invisible_mark></A><TT>remind.annual.task</TT>  or <A NAME="8877"><tex2html_anchor_invisible_mark></A><TT>remind.semestrial.task</TT>.

<P>
<I>Sympa</I> provides several task models stored in <A NAME="8881"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/bin/etc/global_task_models</TT> 
  and <A NAME="8884"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/bin/etc/list_task_models</TT> directories.
Others can be designed by the listmaster. 

<P>
A task is global or related to a list.

<P>

<H2><A NAME="SECTION001781000000000000000">
16.8.1 List task creation</A>
</H2>

<P>
You define in the list config file the model and the version you want to use (see 
<A HREF=<tex2html_cr_mark>#list-task-parameters#2134><tex2html_cr_mark></A>, page~<A HREF=<tex2html_cr_mark>#list-task-parameters#2135><tex2html_cross_ref_visible_mark></A>). Then the task manager daemon will automatically 
create the task by looking for the appropriate model file in different directories in the
following order :

<P>

<OL>
<LI><A NAME="8899"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/expl/<TT>;SPMlt;</TT>list name<TT>;SPMgt;</TT>/</TT>
</LI>
<LI><A NAME="8908"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/etc/list_task_models/</TT>
</LI>
<LI><A NAME="8911"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/bin/etc/list_task_models/</TT>
</LI>
</OL>

<P>
See also <A HREF=<tex2html_cr_mark>#Listmodelfiles#2142><tex2html_cr_mark></A>, page~<A HREF=<tex2html_cr_mark>#Listmodelfiles#2143><tex2html_cross_ref_visible_mark></A>, to know more about standard list models provided with <I>Sympa</I>.

<P>

<H2><A NAME="SECTION001782000000000000000">
16.8.2 Global task creation</A>
</H2>

<P>
The task manager daemon checks if a version of a global task model is specified in <A NAME="8915"><tex2html_anchor_invisible_mark></A><TT>sympa.conf</TT> 
and then creates a task as soon as it finds the model file by looking in different directories
in the following order :

<P>

<OL>
<LI><A NAME="8918"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/etc/global_task_models/</TT>
</LI>
<LI><A NAME="8921"><tex2html_anchor_invisible_mark></A><TT>/usr/local/sympa-gb/bin/etc/global_task_models/</TT>
</LI>
</OL>

<P>

<H2><A NAME="SECTION001783000000000000000">
16.8.3 Model file format</A>
</H2>

<P>
Model files are composed of comments, labels, references, variables, date values
and commands. All those syntactical elements are composed of alphanumerics (0-9a-zA-Z) and underscores (_).

<P>

<UL>
<LI>Comment lines begin by '#' and are not interpreted by the task manager.
</LI>
<LI>Label lines begin by '/' and are used by the next command (see below).
</LI>
<LI>References are enclosed between brackets '[]'. They refer to a value 
depending on the object of the task (for instance [list-<TT>;SPMgt;</TT>name]). Those variables
are instantiated when a task file is created from a model file. The list of available 
variables is the same as for templates (see <A HREF=<tex2html_cr_mark>#list-tpl#2153><tex2html_cr_mark></A>, see 
page~<A HREF=<tex2html_cr_mark>#list-tpl#2154><tex2html_cross_ref_visible_mark></A>) plus [creation_date] (see below).
</LI>
<LI>Variables store results of some commands and are paramaters for others.
Their name begins with '@'.
</LI>
<LI>A date value may be written in two ways :

<P>

<UL>
<LI>absolute dates follow the format : xxxxYxxMxxDxxHxxMin. Y is the year, 
		M the month (1-12), D the day (1-28<TT>|</TT>30<TT>|</TT>31, leap-years are not managed),
		H the hour (0-23), Min the minute (0-59). H and Min are optionnals.
		For instance, 2001y12m4d44min is the 4th of December 2001 at 00h44.

<P>
</LI>
<LI>relative dates use the [creation_date] or [execution_date] references. 
		[creation_date] is the date when the task file is created, [execution_date] 
		when the command line is executed.
		A duration may follow with '+' or '-' operators. The duration is expressed 
		like an absolute date whose all parameters are optionnals. 	
		Examples : [creation_date], [execution_date]+1y, [execution_date]-6m4d
	
</LI>
</UL>

<P>
</LI>
<LI>Command arguments are separated by commas and enclosed between parenthesis '()'.
</LI>
</UL>

<P>
Here is the list of current avalable commands :

<UL>
<LI>stop ()

<P>
Stops the execution of the task and delete the task file
</LI>
<LI>next (<TT>;SPMlt;</TT>date value<TT>;SPMgt;</TT>, <TT>;SPMlt;</TT>label<TT>;SPMgt;</TT>)

<P>
Stop the execution. The task will go on at the date value and begin at the label line.
</LI>
<LI><TT>;SPMlt;</TT><#2166#><#2166#>deleted_users<TT>;SPMgt;</TT> = delete_subs (<TT>;SPMlt;</TT><#2169#><#2169#>user_selection<TT>;SPMgt;</TT>)

<P>
Delete @user_selection email list and stores user emails successfully deleted in @deleted_users.
</LI>
<LI>send_msg (<TT>;SPMlt;</TT><#2172#><#2172#>user_selection<TT>;SPMgt;</TT>, <TT>;SPMlt;</TT>template<TT>;SPMgt;</TT>)

<P>
Send the template message to emails stored in @user_selection.
</LI>
<LI><#2176#><#2176#>user_selection = select_subs (<TT>;SPMlt;</TT>condition<TT>;SPMgt;</TT>)

<P>
Store emails which match the condition in @user_selection. See 8.6 Authorization Scenarios section to know how to write conditions. Only available for list models.
</LI>
<LI>create (global | list (<TT>;SPMlt;</TT>list name<TT>;SPMgt;</TT>), <TT>;SPMlt;</TT>model type<TT>;SPMgt;</TT>, <TT>;SPMlt;</TT>model<TT>;SPMgt;</TT>)

<P>
Create a task for object with model file <A NAME="8924"><tex2html_anchor_invisible_mark></A><TT>&#126;model type.model.task</TT>.
</LI>
<LI>chk_cert_expiration (<TT>;SPMlt;</TT>template<TT>;SPMgt;</TT>, <TT>;SPMlt;</TT>date value<TT>;SPMgt;</TT>)

<P>
Send the template message to emails whose certificate has expired or will expire before the date value.
</LI>
<LI>update_crl (<TT>;SPMlt;</TT>file name<TT>;SPMgt;</TT>, <TT>;SPMlt;</TT>date value<TT>;SPMgt;</TT>)

<P>
Update certificate revocation lists (CRL) which are expired or will expire before the date value. The file stores the CRL's URLs.

<P>
</LI>
<LI>purge_orphan_bounces()

<P>
Clean bounces by removing unsubscribed-users archives.

<P>
</LI>
<LI>eval_bouncers()

<P>
Evaluate all bouncing users of all list and give them a score from 0 to 100. (0 = no bounces for this user, 100 is for users who should be removed).

<P>
</LI>
<LI>process_bouncers()

<P>
Execute actions defined in list configuration on each bouncing users, according to their score.
</LI>
</UL>

<P>
Model files may have a scenario-like title line at the beginning.

<P>
When you change a configuration file by hand, and a task parameter is created or modified, it is up to you
to remove existing task files in the <A NAME="8929"><tex2html_anchor_invisible_mark></A><TT>task/</TT> spool if needed. Task file names have the following format : 

<P>
<A NAME="8962"><tex2html_anchor_invisible_mark></A><TT><TT>;SPMlt;</TT>date<TT>;SPMgt;</TT>.<TT>;SPMlt;</TT>label<TT>;SPMgt;</TT>.<TT>;SPMlt;</TT>model name<TT>;SPMgt;</TT>.<TT>;SPMlt;</TT>list name | global<TT>;SPMgt;</TT></TT> where :

<P>

<UL>
<LI>date is when the task is executed, it is an epoch date
</LI>
<LI>label states where in the task file the execution begins. If empty, starts at the beginning 
</LI>
</UL>

<P>

<H2><A NAME="SECTION001784000000000000000">
16.8.4 Model file examples</A>
</H2>

<P>

<UL>
<LI>remind.annual.task
	<A NAME="remind-annual-task"><tex2html_anchor_mark></A>	<BLOCKQUOTE>
</BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim334#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>

<P>
</LI>
<LI>expire.annual.task
	<A NAME="expire-annual-task"><tex2html_anchor_mark></A>	<BLOCKQUOTE>
</BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim335#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>

<P>
</LI>
<LI>crl_update.daily.task
<BR>	<BLOCKQUOTE>
</BLOCKQUOTE><PRE><tex2html_verbatim_mark>verbatim336#</PRE><BLOCKQUOTE>
</BLOCKQUOTE>

<P>
</LI>
</UL>

<P>

